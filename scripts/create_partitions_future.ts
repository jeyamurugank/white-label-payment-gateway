import { Client } from 'pg';const client=new Client({ connectionString: process.env.DATABASE_URL });async function main(){await client.connect();const months=parseInt(process.env.PARTITION_MONTHS||'36',10);const start=new Date();start.setDate(1);for(let i=0;i<months;i++){const d=new Date(start.getFullYear(), start.getMonth()+i,1);const name=`transactions_${d.getFullYear()}_${('0'+(d.getMonth()+1)).slice(-2)}`;const from=d.toISOString();const next=new Date(d.getFullYear(), d.getMonth()+1,1).toISOString();const sql=`CREATE TABLE IF NOT EXISTS payment_gateway.${name} PARTITION OF payment_gateway.transactions FOR VALUES FROM ('${from}') TO ('${next}');`;try{await client.query(sql);console.log('Ensured',name);}catch(e){console.error('Error creating',name,e.message);} }await client.end();}main().catch(e=>{console.error(e);process.exit(1);});